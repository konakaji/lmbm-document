# 10個の分子の原子座標と原子種分析

## 概要

QM7データセットから生成された10個の分子について、`atom_positions.pt`と`atom_type.pt`の詳細な分析を行いました。これらのファイルは`dataprep.py`によって前処理され、機械学習モデルの訓練に使用されます。

## 原子種のインデックスマッピング

```python
element_to_index = {
    'H': 0, 'S': 1, 'Li': 2, 'Be': 3, 'B': 4, 
    'C': 5, 'N': 6, 'O': 7, 'F': 8
}
```

## 各分子の詳細情報

### 分子 0: CH4 (メタン)
- **原子数**: 5
- **原子種**: ['C', 'H', 'H', 'H', 'H']
- **原子種インデックス**: [5, 0, 0, 0, 0]
- **座標 (Angstrom)**:
  - 0: C (   0.998,   -0.002,   -0.004)
  - 1: H (   2.090,   -0.002,    0.004)
  - 2: H (   0.634,    1.027,    0.004)
  - 3: H (   0.627,   -0.528,    0.878)
  - 4: H (   0.641,   -0.507,   -0.905)
- **座標統計**:
  - x: 平均=0.998, 標準偏差=0.564
  - y: 平均=-0.003, 標準偏差=0.564
  - z: 平均=-0.005, 標準偏差=0.564

### 分子 1: C2H6 (エタン)
- **原子数**: 8
- **原子種**: ['C', 'C', 'H', 'H', 'H', 'H', 'H', 'H']
- **原子種インデックス**: [5, 5, 0, 0, 0, 0, 0, 0]
- **座標 (Angstrom)**:
  - 0: C (   1.004,   -0.003,   -0.006)
  - 1: C (   2.516,   -0.007,    0.001)
  - 2: H (   0.622,    1.022,   -0.002)
  - 3: H (   0.614,   -0.520,    0.876)
  - 4: H (   0.622,   -0.508,   -0.899)
  - 5: H (   2.898,    0.502,    0.891)
  - 6: H (   2.906,    0.506,   -0.884)
  - 7: H (   2.898,   -1.032,    0.000)
- **座標統計**:
  - x: 平均=1.760, 標準偏差=1.057
  - y: 平均=-0.005, 標準偏差=0.627
  - z: 平均=-0.003, 標準偏差=0.627

### 分子 2: C2H4 (エチレン)
- **原子数**: 6
- **原子種**: ['C', 'C', 'H', 'H', 'H', 'H']
- **原子種インデックス**: [5, 5, 0, 0, 0, 0]
- **座標 (Angstrom)**:
  - 0: C (   0.989,    0.000,    0.000)
  - 1: C (   2.325,   -0.000,    0.000)
  - 2: H (   0.429,    0.930,    0.000)
  - 3: H (   0.429,   -0.930,    0.000)
  - 4: H (   2.885,    0.930,    0.000)
  - 5: H (   2.885,   -0.930,    0.000)
- **座標統計**:
  - x: 平均=1.657, 標準偏差=1.074
  - y: 平均=-0.000, 標準偏差=0.759
  - z: 平均=0.000, 標準偏差=0.000

### 分子 3: C2H2 (アセチレン)
- **原子数**: 4
- **原子種**: ['C', 'C', 'H', 'H']
- **原子種インデックス**: [5, 5, 0, 0]
- **座標 (Angstrom)**:
  - 0: C (   0.995,    0.000,    0.000)
  - 1: C (   2.195,    0.000,    0.000)
  - 2: H (  -0.071,    0.000,    0.000)
  - 3: H (   3.261,    0.000,    0.000)
- **座標統計**:
  - x: 平均=1.595, 標準偏差=1.252
  - y: 平均=0.000, 標準偏差=0.000
  - z: 平均=0.000, 標準偏差=0.000

### 分子 4: C2H6O (エタノール)
- **原子数**: 9
- **原子種**: ['C', 'C', 'O', 'H', 'H', 'H', 'H', 'H', 'H']
- **原子種インデックス**: [5, 5, 7, 0, 0, 0, 0, 0, 0]
- **座標 (Angstrom)**:
  - 0: C (   1.005,   -0.001,    0.004)
  - 1: C (   2.520,    0.002,    0.001)
  - 2: O (   3.004,    1.337,    0.012)
  - 3: H (   0.618,   -1.022,    0.011)
  - 4: H (   0.617,    0.518,   -0.877)
  - 5: H (   0.622,    0.530,    0.881)
  - 6: H (   2.912,   -0.507,   -0.885)
  - 7: H (   2.906,   -0.508,    0.890)
  - 8: H (   2.666,    1.777,   -0.786)
- **座標統計**:
  - x: 平均=1.874, 標準偏差=1.051
  - y: 平均=0.236, 標準偏差=0.853
  - z: 平均=-0.083, 標準偏差=0.639

### 分子 5: C2H4O (アセトアルデヒド)
- **原子数**: 7
- **原子種**: ['C', 'C', 'O', 'H', 'H', 'H', 'H']
- **原子種インデックス**: [5, 5, 7, 0, 0, 0, 0]
- **座標 (Angstrom)**:
  - 0: C (   0.994,    0.009,   -0.002)
  - 1: C (   2.489,    0.038,   -0.011)
  - 2: O (   3.140,    1.048,   -0.266)
  - 3: H (   0.652,   -1.013,   -0.193)
  - 4: H (   0.603,    0.662,   -0.786)
  - 5: H (   0.630,    0.331,    0.976)
  - 6: H (   2.988,   -0.889,    0.314)
- **座標統計**:
  - x: 平均=1.642, 標準偏差=1.087
  - y: 平均=0.027, 標準偏差=0.703
  - z: 平均=0.005, 標準偏差=0.504

### 分子 6: C2H6O (ジメチルエーテル)
- **原子数**: 9
- **原子種**: ['C', 'O', 'C', 'H', 'H', 'H', 'H', 'H', 'H']
- **原子種インデックス**: [5, 7, 5, 0, 0, 0, 0, 0, 0]
- **座標 (Angstrom)**:
  - 0: C (   0.983,   -0.002,    0.005)
  - 1: O (   2.403,    0.024,    0.000)
  - 2: C (   2.901,    1.354,   -0.005)
  - 3: H (   0.656,   -1.046,    0.003)
  - 4: H (   0.588,    0.489,   -0.890)
  - 5: H (   0.594,    0.485,    0.904)
  - 6: H (   3.994,    1.313,   -0.003)
  - 7: H (   2.571,    1.890,    0.890)
  - 8: H (   2.573,    1.883,   -0.904)
- **座標統計**:
  - x: 平均=1.918, 標準偏差=1.172
  - y: 平均=0.710, 標準偏差=0.925
  - z: 平均=0.000, 標準偏差=0.598

### 分子 7: C3H6 (プロピレン)
- **原子数**: 9
- **原子種**: ['C', 'C', 'C', 'H', 'H', 'H', 'H', 'H', 'H']
- **原子種インデックス**: [5, 5, 5, 0, 0, 0, 0, 0, 0]
- **座標 (Angstrom)**:
  - 0: C (  -0.027,    0.866,   -0.057)
  - 1: C (  -0.736,   -0.458,   -0.057)
  - 2: C (   0.763,   -0.408,    0.043)
  - 3: H (   0.016,    1.421,   -0.987)
  - 4: H (  -0.106,    1.486,    0.829)
  - 5: H (  -1.172,   -0.801,   -0.987)
  - 6: H (  -1.295,   -0.736,    0.829)
  - 7: H (   1.218,   -0.652,    0.996)
  - 8: H (   1.341,   -0.717,   -0.821)
- **座標統計**:
  - x: 平均=0.000, 標準偏差=0.911
  - y: 平均=-0.000, 標準偏差=0.911
  - z: 平均=-0.024, 標準偏差=0.745

### 分子 8: C3H8 (プロパン)
- **原子数**: 11
- **原子種**: ['C', 'C', 'C', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H']
- **原子種インデックス**: [5, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0]
- **座標 (Angstrom)**:
  - 0: C (   0.990,   -0.013,    0.004)
  - 1: C (   2.509,    0.017,    0.008)
  - 2: C (   3.042,    1.439,    0.006)
  - 3: H (   0.631,   -1.047,    0.001)
  - 4: H (   0.590,    0.488,   -0.883)
  - 5: H (   0.585,    0.484,    0.892)
  - 6: H (   2.887,   -0.515,   -0.872)
  - 7: H (   2.882,   -0.511,    0.893)
  - 8: H (   2.711,    1.981,   -0.886)
  - 9: H (   4.136,    1.435,    0.015)
  - 10: H (   2.697,    1.989,    0.888)
- **座標統計**:
  - x: 平均=2.151, 標準偏差=1.171
  - y: 平均=0.522, 標準偏差=1.005
  - z: 平均=0.006, 標準偏差=0.654

### 分子 9: C3H6 (シクロプロパン)
- **原子数**: 9
- **原子種**: ['C', 'C', 'C', 'H', 'H', 'H', 'H', 'H', 'H']
- **原子種インデックス**: [5, 5, 5, 0, 0, 0, 0, 0, 0]
- **座標 (Angstrom)**:
  - 0: C (   0.975,   -0.010,    0.008)
  - 1: C (   2.467,    0.026,    0.011)
  - 2: C (   3.176,    1.162,   -0.010)
  - 3: H (   0.628,   -1.048,   -0.037)
  - 4: H (   0.571,    0.514,   -0.864)
  - 5: H (   0.573,    0.438,    0.921)
  - 6: H (   2.990,   -0.927,    0.030)
  - 7: H (   2.692,    2.134,   -0.028)
  - 8: H (   4.261,    1.141,   -0.008)
- **座標統計**:
  - x: 平均=2.037, 標準偏差=1.298
  - y: 平均=0.381, 標準偏差=0.961
  - z: 平均=0.003, 標準偏差=0.421

## データ構造の特徴

### ファイル形式
- **`atom_positions.pt`**: PyTorchテンソル形式、形状 `(n_atoms, 3)`
- **`atom_type.pt`**: 文字列配列形式、形状 `(n_atoms,)`

### 座標系
- **単位**: Angstrom (Å)
- **座標系**: 3次元直交座標系 (x, y, z)
- **データ型**: `torch.float32`

### 分子の多様性
1. **原子数**: 4個（アセチレン）から11個（プロパン）まで
2. **原子種**: C, H, O の3種類
3. **分子タイプ**: 
   - 飽和炭化水素（メタン、エタン、プロパン）
   - 不飽和炭化水素（エチレン、アセチレン、プロピレン）
   - 酸素含有化合物（エタノール、アセトアルデヒド、ジメチルエーテル）
   - 環状化合物（シクロプロパン）

### 座標の統計的特徴
- **x座標**: 平均値は分子の中心に近く、標準偏差は分子のサイズを反映
- **y座標**: 分子の対称性により平均値は0に近い
- **z座標**: 平面分子（エチレン、アセチレン）では0に近い

## 機械学習での使用

### 入力データとしての役割
- **原子座標**: 分子の幾何学的構造を表現
- **原子種**: 各原子の化学的性質を表現

### E3NNとの互換性
- **回転等変性**: 分子の回転に対して不変な表現
- **並進不変性**: 分子の並進に対して不変な表現
- **置換等変性**: 同種原子の置換に対して等変な表現

### 前処理の重要性
- **正規化**: 座標のスケール統一
- **パディング**: 異なるサイズの分子のバッチ処理
- **特徴エンコーディング**: 原子種の数値化

## まとめ

この10個の分子は、QM7データセットの多様性を代表するサンプルとして機能し、機械学習モデルの訓練において重要な役割を果たします。各分子の原子座標と原子種情報は、E3NNなどの等変ニューラルネットワークで効率的に処理され、分子の物理化学的性質の予測に使用されます。
